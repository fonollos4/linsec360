2025-07-25 13:12:24,654 p=34 u=linsecagent n=ansible WARNING| [WARNING]: Failed to create the directory '/home/linsecagent/.ansible': [Errno
2] No such file or directory: '/home/linsecagent/.ansible'

2025-07-25 13:12:24,989 p=34 u=linsecagent n=ansible ERROR| ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  found unacceptable key (unhashable type: 'AnsibleMapping'). while constructing a mapping
  in "<unicode string>", line 2, column 10
found unacceptable key (unhashable type: 'AnsibleMapping')
  in "<unicode string>", line 2, column 11

The error appears to be in '/opt/linsec/taskengine/playbooks/wazuh-agent.yml': line 2, column 11, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

---
- hosts: {{ servernames }}
          ^ here
We could be wrong, but this one looks like it might be an issue with
missing quotes. Always quote template expression brackets when they
start a value. For instance:

    with_items:
      - {{ foo }}

Should be written as:

    with_items:
      - "{{ foo }}"

